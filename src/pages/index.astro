---
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import Card from "@/components/Card.astro";
import Hr from "@/components/Hr.astro";
import getSortedPosts from "@/utils/getSortedPosts";
import { SITE } from "@/config";

const posts = await getCollection("blog");
const sortedPosts = getSortedPosts(posts);
const featuredPosts = sortedPosts.filter(({ data }) => data.featured);
const recentPosts = sortedPosts.filter(({ data }) => !data.featured);
---

<Layout>
  <Header>
    <style>
      :root {
        --ink: #2e2e2e;
        --paper: #fafafa;
        --accent: #8c9a5b;
        --font-serif: "Noto Serif SC", serif;
        --font-sans: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", sans-serif;
      }
      *{margin:0;padding:0;box-sizing:border-box;}
      body{
        background:var(--paper);
        color:var(--ink);
        font-family:var(--font-serif);
        line-height:1.9;
        letter-spacing:.05em;
      }
      /* ---------- å®½åº¦ä¸ Header å¯¹é½ ---------- */
      .container{
        width:100%;
        max-width:768px;      /* ä¸ Header çš„ max-w-3xl ç›¸åŒ */
        margin:0 auto;
        padding:8vw 1.5rem;   /* å·¦å³ç•™ç™½ç»™ç§»åŠ¨ç«¯ */
      }
      /* --------------------------------------- */
      h1,h2,h3{font-family:var(--font-sans);font-weight:400;}
      h1{font-size:clamp(1.6rem,3vw,2.2rem);margin-bottom:2rem;color:var(--accent);}
      h2{font-size:1.1rem;margin:2.5rem 0 .8rem;border-left:2px solid var(--accent);padding-left:.6rem;}
      .section-title{font-size:1.5rem;margin-bottom:.75rem;font-weight:600;letter-spacing:.025em;}
      p{margin-bottom:1rem;}
      a{color:var(--accent);text-decoration:none;border-bottom:1px solid transparent;transition:border .2s;}
      a:hover{border-bottom-color:var(--accent);}
      .contact span{display:block;margin:.2rem 0;}
      @media(max-width:768px){
        .container{padding:6vw 1rem;}
      }
    </style>
  </Header>

  <main>
    <div class="container">
      <!-- 1. è¯—æ­Œ -->
      <h1>æŠŠä¹¦é¡µã€æ³¥åœŸä¸æ—¥å¸¸æŠ˜è¿›åŒä¸€æŸå…‰é‡Œã€‚</h1>

      <!-- 2. å…³äºæˆ‘ -->
      <section>
        <h2>å…³äºæˆ‘</h2>
        <p>
          ä½ å¥½ï¼Œæˆ‘æ˜¯ Night Owlongã€‚<br>
          ç™½å¤©åœ¨è¯¾æ¡Œå‰èƒ¡æ€ä¹±æƒ³ï¼Œæ™šä¸Šåœ¨ç¯ä¸‹è¡¥è¯»ä¹¦ç¬”è®°ã€‚<br>
          ç›¸ä¿¡çŸ¥è¯†åƒæ°´ï¼Œä¿æŒä½æ‰èƒ½æ»‹å…»æ›´å¤šç”Ÿå‘½ï¼›<br>
          ç›¸ä¿¡æ–‡å­—åƒå…‰ï¼Œç®€çŸ­ä¹Ÿèƒ½ç…§å¾—å¾ˆè¿œã€‚
        </p>
      </section>

      <!-- 3. ä¸æˆ‘è”ç³» -->
      <section class="contact">
        <h2>ä¸æˆ‘è”ç³»</h2>
        <span>ğŸ“ ç”µè¯ï¼š<a href="tel:+8615330353774">+86 153 3035 3774</a></span>
        <span>ğŸ“§ é‚®ç®±ï¼š<a href="mailto:starsdusts@foxmail.com">starsdusts@foxmail.com</a></span>
        <p>
          æ¬¢è¿æ¥ä¿¡äº¤æ¢ä¹¦å•ã€åˆ†äº«å®éªŒï¼Œæˆ–åªæ˜¯è¯´ä¸€å¥ã€Œä»Šå¤©ä¹Ÿæœ‰è¢«æ²»æ„ˆåˆ°ã€ã€‚<br>
          ç•™è¨€é€šå¸¸åœ¨ 24h å†…å›å¤ï¼›è‹¥é‡é‡å¤–é‡‡æ ·ï¼Œè¯·å…è®¸æˆ‘å¤šå¸¦ä¸€ç‚¹æ³¥åœŸçš„æ°”æ¯å›æ¥ã€‚
        </p>
      </section>

      <footer>
        <p>æç®€ç•™ç™½ï¼Œæ˜¯ä¸ºäº†ç»™ä½ æ›´å¤šå‘¼å¸çš„ç©ºé—´ã€‚</p>
      </footer>

      <Hr />

      <!-- 4. Featured -->
      {featuredPosts.length > 0 && (
        <section id="featured">
          <h2 class="section-title">Featured</h2>
          <ul>
            {featuredPosts.map(data => <Card variant="h3" {...data} />)}
          </ul>
        </section>
      )}

      <!-- 5. Recent Posts -->
      {recentPosts.length > 0 && (
        <>
          {featuredPosts.length > 0 && <Hr />}
          <section id="recent-posts">
            <h2 class="section-title">Recent Posts</h2>
            <ul>
              {recentPosts.map(
                (data, i) =>
                  i < SITE.postPerIndex && <Card variant="h3" {...data} />
              )}
            </ul>
          </section>
        </>
      )}
    </div>
  </main>

  <Footer />
</Layout>